<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <title>ä»˜è´¹MBTIæµ‹è¯• - æ™ºèƒ½MBTI</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="src/css/styles.css">
  <style>
    .circle-progress-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 2rem;
    }
    .circle-progress {
      position: relative;
      width: 112px;
      height: 112px;
    }
    .circle-progress svg {
      transform: rotate(-90deg);
    }
    .circle-progress .progress-bg {
      stroke: #e5e7eb;
      stroke-width: 10;
      fill: none;
    }
    .circle-progress .progress-bar {
      stroke: #2563eb;
      stroke-width: 10;
      fill: none;
      stroke-linecap: round;
      transition: stroke-dashoffset 0.5s;
    }
    .circle-progress .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.5rem;
      font-weight: 700;
      color: #2563eb;
      text-align: center;
    }
    .circle-progress .progress-label {
      margin-top: 0.5rem;
      font-size: 1rem;
      color: #4b5563;
      text-align: center;
    }
  </style>
</head>
<body class="font-sans text-gray-800 bg-gray-50">
  <!-- å¤´éƒ¨å¯¼èˆª -->
  <header class="fixed w-full bg-white bg-opacity-95 shadow-sm z-50 transition duration-300">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center">
          <a href="index.html" class="flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
            <span class="ml-2 text-xl font-bold text-gray-900">æ™ºèƒ½MBTI</span>
          </a>
        </div>
        <!-- ç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
        <div class="md:hidden">
          <button type="button" class="text-gray-500 hover:text-gray-600 focus:outline-none" id="mobile-menu-button">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
        <!-- æ¡Œé¢ç«¯å¯¼èˆª -->
        <nav class="hidden md:flex justify-center items-center space-x-8">
          <a href="index.html" class="text-gray-600 hover:text-blue-600 transition-colors">é¦–é¡µ</a> 
          <a href="mbtiqa.html" class="text-gray-600 hover:text-blue-600 transition-colors">æœ‰è¶£é—®ç­”</a>
          <a href="mbtifacts.html" class="text-gray-600 hover:text-blue-600 transition-colors">è¶£å‘³çŸ¥è¯†</a>
          <a href="dailytips.html" class="text-gray-600 hover:text-blue-600 transition-colors">æ¯å¤©è§‰æ‚Ÿ</a>
          <a href="booksblog.html" class="text-gray-600 hover:text-blue-600 transition-colors">è¯»ä¹¦æ¨è</a>
          <a href="price.html" class="text-gray-600 hover:text-blue-600 transition-colors">å¥—é¤ä»·æ ¼</a>
          <a href="aboutus.html" class="text-gray-600 hover:text-blue-600 transition-colors">å…³äºæˆ‘ä»¬</a>
          <a href="test.html" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">å¼€å§‹æµ‹è¯•</a>
        </nav>
      </div>
      <!-- ç§»åŠ¨ç«¯èœå• -->
      <div class="md:hidden hidden bg-white pb-4" id="mobile-menu">
        <nav class="flex flex-col space-y-4">
          <a href="index.html" class="text-gray-600 hover:text-blue-600 transition-colors">é¦–é¡µ</a>
          <a href="mbtiqa.html" class="text-gray-600 hover:text-blue-600 transition-colors">æœ‰è¶£é—®ç­”</a>
          <a href="mbtifacts.html" class="text-gray-600 hover:text-blue-600 transition-colors">è¶£å‘³çŸ¥è¯†</a>
          <a href="dailytips.html" class="text-gray-600 hover:text-blue-600 transition-colors">æ¯å¤©è§‰æ‚Ÿ</a>
          <a href="booksblog.html" class="text-gray-600 hover:text-blue-600 transition-colors">è¯»ä¹¦æ¨è</a>
          <a href="price.html" class="text-gray-600 hover:text-blue-600 transition-colors">å¥—é¤ä»·æ ¼</a>
          <a href="aboutus.html" class="text-gray-600 hover:text-blue-600 transition-colors">å…³äºæˆ‘ä»¬</a>
          <a href="test.html" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-center">å¼€å§‹æµ‹è¯•</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- ä¸»è¦å†…å®¹ -->
  <main class="pt-28 md:pt-32">
    <section class="pt-8 pb-16">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <!-- æµ‹è¯•ä»‹ç» -->
        <div class="text-center mb-8" id="test-intro">
          <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">ä»˜è´¹ä¸“ä¸šMBTIæ€§æ ¼æµ‹è¯•</h1>
          <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-8">
            æœ¬æµ‹è¯•åŒ…å«100ä¸ªç²¾å¿ƒè®¾è®¡çš„é—®é¢˜ï¼Œå¤§çº¦éœ€è¦25åˆ†é’Ÿå®Œæˆã€‚åŸºäºå®˜æ–¹MBTIç†è®ºï¼Œæä¾›æ›´æ·±å…¥ã€æ›´å‡†ç¡®çš„æ€§æ ¼åˆ†æã€‚è¯·æ ¹æ®æ‚¨çš„ç¬¬ä¸€ååº”é€‰æ‹©æœ€ç¬¦åˆè‡ªå·±çš„é€‰é¡¹ï¼Œæ²¡æœ‰å¯¹é”™ä¹‹åˆ†ã€‚æµ‹è¯•å®Œæˆåéœ€è¦æ”¯ä»˜ä»¥æŸ¥çœ‹è¯¦ç»†çš„ä¸“ä¸šæŠ¥å‘Šã€‚
          </p>
          <div id="inspiration-quote" class="text-blue-600 text-xl font-semibold italic mb-8 min-h-[2.5rem] opacity-100 transition-opacity duration-1000">
            åŠ è½½ä¸­...
          </div>
          <button id="start-test-btn" class="bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-medium hover:bg-blue-700 transition-colors shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
            å¼€å§‹ä¸“ä¸šæµ‹è¯•
            <span class="block text-sm mt-1 font-normal">100ä¸ªé—®é¢˜ Â· çº¦25åˆ†é’Ÿ</span>
          </button>
          <div class="mt-8 max-w-4xl mx-auto px-4 text-left space-y-10">
            <!-- å°è´´å£« -->
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded shadow-sm">
              <h2 class="text-lg font-semibold text-blue-800 mb-2">ğŸŒŸ ä¸“ä¸šæµ‹è¯•ç‰¹è‰²</h2>
              <ul class="list-disc list-inside text-blue-700">
                <li>åŸºäºå®˜æ–¹MBTIç†è®ºï¼Œ100é“ç²¾å¿ƒè®¾è®¡çš„é¢˜ç›®</li>
                <li>æä¾›è¯¦ç»†çš„æ€§æ ¼åˆ†ææŠ¥å‘Šå’ŒèŒä¸šå»ºè®®</li>
                <li>åŒ…å«æ·±åº¦çš„äººé™…å…³ç³»å’Œæˆé•¿å»ºè®®</li>
                <li>æµ‹è¯•å®Œæˆåéœ€æ”¯ä»˜æŸ¥çœ‹å®Œæ•´ä¸“ä¸šæŠ¥å‘Š</li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- æµ‹è¯•è¿›åº¦æ¡ï¼ˆåœ†å½¢è¿›åº¦æ¡æ ·å¼ï¼‰ -->
        <div class="hidden mb-8" id="test-progress-container">
          <div class="circle-progress-container">
            <div class="circle-progress">
              <svg width="112" height="112" viewBox="0 0 112 112">
                <circle class="progress-bg" cx="56" cy="56" r="50" />
                <circle
                  class="progress-bar"
                  id="progress-circle"
                  cx="56"
                  cy="56"
                  r="50"
                  stroke-dasharray="314.159"
                  stroke-dashoffset="314.159"
                />
              </svg>
              <div class="progress-text" id="completion-percentage">1%</div>
            </div>
            <div class="progress-label" id="question-number">é—®é¢˜ 1/100</div>
          </div>
        </div>

        <!-- æµ‹è¯•é—®é¢˜åŒºåŸŸ -->
        <div class="hidden" id="test-questions">
          <div class="max-w-3xl mx-auto">
            <div class="bg-white rounded-lg shadow-lg p-8">
              <h2 class="text-xl font-semibold text-gray-900 mb-6" id="question-text">
                åŠ è½½é—®é¢˜ä¸­...
              </h2>
              
              <div class="space-y-4">
                <label class="flex items-start space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                  <input type="radio" name="question" value="0" class="mt-1 text-blue-600 focus:ring-blue-500">
                  <span class="flex-1">
                    <span class="font-medium text-gray-900">é€‰é¡¹A</span>
                  </span>
                </label>
                
                <label class="flex items-start space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                  <input type="radio" name="question" value="1" class="mt-1 text-blue-600 focus:ring-blue-500">
                  <span class="flex-1">
                    <span class="font-medium text-gray-900">é€‰é¡¹B</span>
                  </span>
                </label>
              </div>
              
              <div class="flex justify-between mt-8">
                <button id="prev-button" class="hidden bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                  ä¸Šä¸€é¢˜
                </button>
                <div class="flex-1"></div>
                <button id="next-button" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                  ä¸‹ä¸€é¢˜
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- å°åŠ©æ‰‹é¼“åŠ±æ¨¡å— -->
        <div class="hidden mt-8" id="encouragement-section">
          <div class="max-w-2xl mx-auto bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200">
            <div class="flex items-start space-x-4">
              <div class="flex-shrink-0">
                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                  </svg>
                </div>
              </div>
              <div class="flex-1">
                <h3 class="text-lg font-semibold text-blue-900 mb-2">å°åŠ©æ‰‹æé†’</h3>
                <p class="text-blue-800" id="encouragement-text">
                  æ‚¨æ­£åœ¨è¿›è¡Œä¸“ä¸šç‰ˆMBTIæµ‹è¯•ï¼Œè¯·ä¿æŒä¸“æ³¨ï¼Œè¯šå®å›ç­”æ¯ä¸ªé—®é¢˜ã€‚æ‚¨çš„åšæŒå°†è·å¾—æ›´å‡†ç¡®çš„æ€§æ ¼åˆ†æï¼
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- é¡µè„š -->
  <footer class="bg-gray-900 text-white py-8">
    <div class="container mx-auto px-4 text-center">
      <div class="flex items-center justify-center mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <span class="ml-2 text-lg font-bold">æ™ºèƒ½MBTI</span>
      </div>
      <p class="text-gray-400 mb-4">
        æ¢ç´¢è‡ªæˆ‘ï¼Œå‘ç°æ½œèƒ½ï¼Œå¼•é¢†æœªæ¥æ–¹å‘ã€‚
      </p>
      <div class="border-t border-gray-800 pt-4">
        <div class="text-gray-400">
          &copy; 2025 æ™ºèƒ½MBTI - ä¸“ä¸šMBTIæµ‹è¯•. ä¿ç•™æ‰€æœ‰æƒåˆ©.
        </div>
      </div>
    </div>
  </footer>

  <script src="src/js/main.js"></script>
  <script src="src/js/test-packages.js"></script>
  <script src="src/js/test.js"></script>
  
  <script>
    // åŠ±å¿—åè¨€è½®æ’­
    const quotes = [
      "ä¸“ä¸šçš„æµ‹è¯•ï¼Œä¸“ä¸šçš„ä½ ã€‚",
      "æ·±åº¦äº†è§£è‡ªå·±ï¼Œæ˜¯æˆåŠŸçš„ç¬¬ä¸€æ­¥ã€‚",
      "æŠ•èµ„è‡ªå·±çš„è®¤çŸ¥ï¼Œæ˜¯æœ€å¥½çš„æŠ•èµ„ã€‚",
      "æ¯ä¸€ä¸ªæ·±å…¥çš„äº†è§£ï¼Œéƒ½æ˜¯æˆé•¿çš„å¼€å§‹ã€‚",
      "ä¸“ä¸šçš„åˆ†æï¼ŒåŠ©ä½ å‘ç°æ›´å¥½çš„è‡ªå·±ã€‚",
      "è®¤è¯†è‡ªå·±ï¼Œæ˜¯æ™ºæ…§çš„å¼€ç«¯ã€‚",
      "ä½ çš„æ€§æ ¼ï¼Œå°±æ˜¯ä½ çš„è¶…èƒ½åŠ›ã€‚",
      "æ·±åº¦æµ‹è¯•ï¼Œæ·±åº¦æˆé•¿ã€‚",
      "äº†è§£è‡ªå·±ï¼Œæ‰èƒ½æ›´å¥½åœ°äº†è§£ä¸–ç•Œã€‚",
      "ä¸“ä¸šæµ‹è¯•ï¼Œä¸“ä¸šæˆé•¿ã€‚"
    ];

    function rotateQuotes() {
      const quoteEl = document.getElementById("inspiration-quote");
      let index = 0;

      const showQuote = () => {
        quoteEl.style.opacity = 0;
        setTimeout(() => {
          quoteEl.textContent = quotes[index];
          quoteEl.style.opacity = 1;
          index = (index + 1) % quotes.length;
        }, 1000);
      };

      showQuote();
      setInterval(showQuote, 8000);
    }

    // åœ†å½¢è¿›åº¦æ¡æ›´æ–°
    function updateCircleProgress(current, total) {
      const circle = document.getElementById('progress-circle');
      const percent = Math.round((current + 1) / total * 100);
      const radius = 50;
      const circumference = 2 * Math.PI * radius;
      const offset = circumference * (1 - percent / 100);
      circle.style.strokeDashoffset = offset;
      document.getElementById('completion-percentage').textContent = percent + '%';
      document.getElementById('question-number').textContent = `é—®é¢˜ ${current + 1}/${total}`;
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      rotateQuotes();
      
      // è®¾ç½®æµ‹è¯•ç±»å‹ä¸ºä¸“ä¸šç‰ˆ
      localStorage.setItem('testType', 'pro');
      localStorage.setItem('testConfig', JSON.stringify({
        type: 'pro',
        questionCount: 100
      }));
      
      const startButton = document.getElementById('start-test-btn');
      const testIntro = document.getElementById('test-intro');
      const testQuestions = document.getElementById('test-questions');
      const progressContainer = document.getElementById('test-progress-container');
      const encouragementSection = document.getElementById('encouragement-section');
      const questionText = document.getElementById('question-text');
      const nextButton = document.getElementById('next-button');
      const prevButton = document.getElementById('prev-button');
      // æ–°å¢åœ†å½¢è¿›åº¦æ¡ç›¸å…³
      const questionNumber = document.getElementById('question-number');
      const completionPercentage = document.getElementById('completion-percentage');
      // const progressBar = document.getElementById('progress-bar'); // ä¸å†éœ€è¦

      let currentQuestionIndex = 0;
      let answers = {};
      let shuffledQuestions = [];
      
      // è·å–æ‰€æœ‰æµ‹è¯•é¢˜ç›®ï¼ˆ100é“ï¼‰
      function getAllQuestions() {
        if (typeof window.questions !== 'undefined' && window.questions.length > 0) {
          const allQuestions = window.questions.concat(window.extendedQuestions || []);
          return allQuestions;
        }
        return getBackupQuestions();
      }
      function getBackupQuestions() {
        return [
          {
            text: "åœ¨ç¤¾äº¤åœºåˆä¸­ï¼Œæ‚¨é€šå¸¸ï¼š",
            options: ["ä¸»åŠ¨ä¸ä»–äººäº¤è°ˆï¼Œæ‰©å±•ç¤¾äº¤åœˆ", "å€¾å‘äºä¸å·²è®¤è¯†çš„äººäº¤æµï¼Œä¿æŒä½è°ƒ"],
            dimension: "EI"
          },
          {
            text: "æ‚¨æ›´å–œæ¬¢çš„å·¥ä½œç¯å¢ƒæ˜¯ï¼š",
            options: ["å¼€æ”¾ã€äº’åŠ¨ã€æœ‰å›¢é˜Ÿåä½œçš„ç¯å¢ƒ", "å®‰é™ã€ç‹¬ç«‹ã€èƒ½å¤Ÿä¸“æ³¨çš„ç©ºé—´"],
            dimension: "EI"
          },
          {
            text: "å½“æ‚¨éœ€è¦æ¢å¤ç²¾åŠ›æ—¶ï¼Œæ‚¨ä¼šé€‰æ‹©ï¼š",
            options: ["ä¸æœ‹å‹ä¸€èµ·å¤–å‡ºæ´»åŠ¨", "ç‹¬è‡ªå®‰é™åœ°é˜…è¯»æˆ–æ”¾æ¾"],
            dimension: "EI"
          },
          {
            text: "å½“è§£å†³é—®é¢˜æ—¶ï¼Œæ‚¨æ›´å€¾å‘äºï¼š",
            options: ["å…³æ³¨å…·ä½“äº‹å®å’Œç»†èŠ‚", "å…³æ³¨æ•´ä½“æ¨¡å¼å’Œå¯èƒ½æ€§"],
            dimension: "SN"
          },
          {
            text: "æ‚¨æ›´ç›¸ä¿¡ï¼š",
            options: ["å®é™…ç»éªŒå’Œè§‚å¯Ÿåˆ°çš„äº‹ç‰©", "ç›´è§‰å’Œçµæ„Ÿ"],
            dimension: "SN"
          },
          {
            text: "åšå†³å®šæ—¶ï¼Œæ‚¨æ›´å€¾å‘äºåŸºäºï¼š",
            options: ["é€»è¾‘åˆ†æå’Œå®¢è§‚å› ç´ ", "ä¸ªäººä»·å€¼è§‚å’Œå¯¹ä»–äººçš„å½±å“"],
            dimension: "TF"
          },
          {
            text: "å½“æœ‹å‹å‘æ‚¨å€¾è¯‰é—®é¢˜æ—¶ï¼Œæ‚¨é€šå¸¸ä¼šï¼š",
            options: ["æä¾›è§£å†³æ–¹æ¡ˆå’Œåˆ†æ", "æä¾›æƒ…æ„Ÿæ”¯æŒå’Œå…±æƒ…"],
            dimension: "TF"
          },
          {
            text: "å…³äºè®¡åˆ’ï¼Œæ‚¨æ›´å€¾å‘äºï¼š",
            options: ["æå‰å®‰æ’ï¼ŒæŒ‰è®¡åˆ’è¡Œäº‹", "ä¿æŒçµæ´»ï¼Œè§†æƒ…å†µè€Œå®š"],
            dimension: "JP"
          },
          {
            text: "æ‚¨çš„å·¥ä½œåŒºåŸŸé€šå¸¸æ˜¯ï¼š",
            options: ["äº•ç„¶æœ‰åºï¼Œç‰©å“å„å½’å…¶ä½", "åˆ›æ„æ€§æ··ä¹±ï¼Œéšæ‰‹å¯åŠ"],
            dimension: "JP"
          },
          {
            text: "é¢å¯¹deadlineï¼Œæ‚¨æ›´å¯èƒ½ï¼š",
            options: ["æå‰å®Œæˆï¼Œé¿å…å‹åŠ›", "ä¸´è¿‘æˆªæ­¢æ—¥æœŸæ‰å®Œæˆï¼Œå—å‹åŠ›é©±åŠ¨"],
            dimension: "JP"
          }
        ];
      }
      // æ˜¾ç¤ºé—®é¢˜
      function displayQuestion(index) {
        const question = shuffledQuestions[index];
        if (!question) return;
        questionText.textContent = question.text;
        const labels = document.querySelectorAll('label span span');
        if (labels.length >= 2) {
          labels[0].textContent = question.options[0];
          labels[1].textContent = question.options[1];
        }
        const radioButtons = document.querySelectorAll('input[name="question"]');
        radioButtons.forEach(radio => radio.checked = false);
        const dimension = question.dimension;
        if (answers[dimension] && answers[dimension][index] !== undefined) {
          const answerIndex = answers[dimension][index];
          if (radioButtons[answerIndex]) {
            radioButtons[answerIndex].checked = true;
          }
        }
        // æ›´æ–°åœ†å½¢è¿›åº¦æ¡
        updateCircleProgress(index, shuffledQuestions.length);
        if (index > 0) {
          prevButton.classList.remove('hidden');
        } else {
          prevButton.classList.add('hidden');
        }
        if (index === shuffledQuestions.length - 1) {
          nextButton.textContent = 'æäº¤';
        } else {
          nextButton.textContent = 'ä¸‹ä¸€é¢˜';
        }
        currentQuestionIndex = index;
      }
      function calculateResults() {
        let scores = {
          E: 0, I: 0,
          S: 0, N: 0,
          T: 0, F: 0,
          J: 0, P: 0
        };
        for (let dimension in answers) {
          for (let i = 0; i < answers[dimension].length; i++) {
            if (answers[dimension][i] !== undefined) {
              if (dimension === 'EI') {
                if (answers[dimension][i] === 0) scores.E++;
                else scores.I++;
              } else if (dimension === 'SN') {
                if (answers[dimension][i] === 0) scores.S++;
                else scores.N++;
              } else if (dimension === 'TF') {
                if (answers[dimension][i] === 0) scores.T++;
                else scores.F++;
              } else if (dimension === 'JP') {
                if (answers[dimension][i] === 0) scores.J++;
                else scores.P++;
              }
            }
          }
        }
        let type = '';
        type += scores.E > scores.I ? 'E' : 'I';
        type += scores.S > scores.N ? 'S' : 'N';
        type += scores.T > scores.F ? 'T' : 'F';
        type += scores.J > scores.P ? 'J' : 'P';
        const eiTotal = scores.E + scores.I;
        const snTotal = scores.S + scores.N;
        const tfTotal = scores.T + scores.F;
        const jpTotal = scores.J + scores.P;
        const eiPercentage = Math.round((type[0] === 'I' ? scores.I : scores.E) / eiTotal * 100);
        const snPercentage = Math.round((type[1] === 'N' ? scores.N : scores.S) / snTotal * 100);
        const tfPercentage = Math.round((type[2] === 'F' ? scores.F : scores.T) / tfTotal * 100);
        const jpPercentage = Math.round((type[3] === 'J' ? scores.J : scores.P) / jpTotal * 100);
        localStorage.setItem('mbtiType', type);
        localStorage.setItem('mbtiPercentages', JSON.stringify({
          eiPercentage,
          snPercentage,
          tfPercentage,
          jpPercentage
        }));
        window.location.href = 'payment.html';
      }
      if (startButton) {
        startButton.addEventListener('click', function() {
          const allQuestions = getAllQuestions();
          if (allQuestions.length >= 100) {
            shuffledQuestions = allQuestions.slice(0, 100);
          } else {
            shuffledQuestions = [];
            while (shuffledQuestions.length < 100) {
              shuffledQuestions = shuffledQuestions.concat(allQuestions);
            }
            shuffledQuestions = shuffledQuestions.slice(0, 100);
          }
          testIntro.classList.add('hidden');
          testQuestions.classList.remove('hidden');
          progressContainer.classList.remove('hidden');
          encouragementSection.classList.remove('hidden');
          displayQuestion(0);
        });
      }
      if (nextButton) {
        nextButton.addEventListener('click', function() {
          const radioButtons = document.querySelectorAll('input[name="question"]');
          let selected = false;
          let selectedValue;
          radioButtons.forEach((radio, index) => {
            if (radio.checked) {
              selected = true;
              selectedValue = index;
            }
          });
          if (!selected) {
            alert('è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹');
            return;
          }
          const question = shuffledQuestions[currentQuestionIndex];
          const dimension = question.dimension;
          if (!answers[dimension]) {
            answers[dimension] = [];
          }
          answers[dimension][currentQuestionIndex] = selectedValue;
          if (currentQuestionIndex < shuffledQuestions.length - 1) {
            displayQuestion(currentQuestionIndex + 1);
          } else {
            calculateResults();
          }
        });
      }
      if (prevButton) {
        prevButton.addEventListener('click', function() {
          if (currentQuestionIndex > 0) {
            displayQuestion(currentQuestionIndex - 1);
          }
        });
      }
    });
  </script>
</body>
</html>
